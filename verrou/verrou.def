Bootstrap: localimage
From: /home/hadrien/Software/singularity-images/spack.sif

%post
    source ${SINGULARITY_ENVIRONMENT}
    spack install verrou@2.1.0
    echo "spack load verrou" >> ${SINGULARITY_ENVIRONMENT}
    spack clean

%test
    source ${SINGULARITY_ENVIRONMENT}
    valgrind --tool=verrou --rounding-mode=upward python -c "print(1./3.)"
    valgrind --tool=verrou --rounding-mode=downward python -c "print(1./3.)"
    
%help
    This container features a Verrou installation on openSUSE Tumbleweed.